{"componentChunkName":"component---src-templates-course-content-template-js","path":"/part-2/5-monitoring","result":{"data":{"page":{"htmlAst":{"type":"element","tagName":"div","properties":{},"children":[{"type":"element","tagName":"text-box","properties":{"variant":"learningObjectives","name":"Learning Objectives"},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"After this section you"}]},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"know of the wide array of tools used for monitoring and can implement simple logging"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"know about CRDs or Custom Resource Definitions"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"know about Helm, the package manager for Kubernetes"}]},{"type":"text","value":"\n"}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Our cluster and the apps in it have so far been pretty much a black box for us. We've thrown stuff in and then hoped that everything works all right. We're now going to use "},{"type":"element","tagName":"a","properties":{"href":"https://prometheus.io/","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Prometheus"}]},{"type":"text","value":" to monitor the cluster and "},{"type":"element","tagName":"a","properties":{"href":"https://grafana.com/","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Grafana"}]},{"type":"text","value":" to view the data."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Before we can get started let's look into how Kubernetes applications are managed more easily. "},{"type":"element","tagName":"a","properties":{"href":"https://helm.sh/","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Helm"}]},{"type":"text","value":" uses a packaging format called "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"charts"}]},{"type":"text","value":" to define the dependencies of an application. Among other things, Helm Charts include information for the version of the chart, the requirements of the application such as the Kubernetes version as well as other charts that it may depend on."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Installation instructions for Helm are found "},{"type":"element","tagName":"a","properties":{"href":"https://helm.sh/docs/intro/install/","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"here"}]},{"type":"text","value":"."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"After the installation, we can add the official charts repository:"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"shell"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-shell"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-shell"]},"children":[{"type":"text","value":"$ helm repo "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"add"}]},{"type":"text","value":" prometheus-community https://prometheus-community.github.io/helm-charts\n$ helm repo "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"add"}]},{"type":"text","value":" stable https://charts.helm.sh/stable"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Next, we can install the "},{"type":"element","tagName":"a","properties":{"href":"https://artifacthub.io/packages/helm/prometheus-community/kube-prometheus-stack","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"kube-prometheus-stack"}]},{"type":"text","value":". By default, this would put everything in the default namespace. Let's create a new namespace and add it there."}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"shell"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-shell"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-shell"]},"children":[{"type":"text","value":"$ kubectl create namespace prometheus\n$ helm "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"install"}]},{"type":"text","value":" prometheus-community/kube-prometheus-stack --generate-name --namespace prometheus\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":".."}]},{"type":"text","value":".\nNAME: kube-prometheus-stack-1635945330\nLAST DEPLOYED: Wed Nov  "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"3"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"15"}]},{"type":"text","value":":15:37 "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"2021"}]},{"type":"text","value":"\nNAMESPACE: prometheus\nSTATUS: deployed\nREVISION: "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"1"}]},{"type":"text","value":"\nNOTES:\nkube-prometheus-stack has been installed. Check its status by running:\n  kubectl --namespace prometheus get pods -l "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"release=kube-prometheus-stack-1635945330\""}]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"This added a lot of stuff to our cluster. Among other things, it added a number of "},{"type":"element","tagName":"a","properties":{"href":"https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"custom resources"}]},{"type":"text","value":". They are a way to extend the Kubernetes APIs to offer new resources that Kubernetes doesn't support out of the box. We will be designing our own custom resources in "},{"type":"element","tagName":"a","properties":{"href":"https://devopswithkubernetes.com/part5/","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"part 5"}]},{"type":"text","value":"."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"You can remove almost anything with "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"helm delete [name]"}]},{"type":"text","value":" with the name found using the command "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"helm list -n prometheus"}]},{"type":"text","value":". Custom resource definitions are left and have to be manually removed if the need arises. The definitions don't do anything by themselves so leaving them does no harm."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Let us open a way into Grafana so we can see the data."}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"shell"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-shell"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-shell"]},"children":[{"type":"text","value":"$ kubectl get po -n prometheus\n NAME                                                              READY   STATUS    RESTARTS   AGE\n kube-prometheus-stack-1602180058-prometheus-node-exporter-nt8cp   "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"1"}]},{"type":"text","value":"/1     Running   "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"0"}]},{"type":"text","value":"          53s\n kube-prometheus-stack-1602180058-prometheus-node-exporter-ft7dg   "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"1"}]},{"type":"text","value":"/1     Running   "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"0"}]},{"type":"text","value":"          53s\n kube-prometheus-stack-1602-operator-557c9c4f5-wbsqc               "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"2"}]},{"type":"text","value":"/2     Running   "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"0"}]},{"type":"text","value":"          53s\n kube-prometheus-stack-1602180058-prometheus-node-exporter-tr7ns   "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"1"}]},{"type":"text","value":"/1     Running   "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"0"}]},{"type":"text","value":"          53s\n kube-prometheus-stack-1602180058-kube-state-metrics-55dccdkkz6w   "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"1"}]},{"type":"text","value":"/1     Running   "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"0"}]},{"type":"text","value":"          53s\n alertmanager-kube-prometheus-stack-1602-alertmanager-0            "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"2"}]},{"type":"text","value":"/2     Running   "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"0"}]},{"type":"text","value":"          35s\n kube-prometheus-stack-1602180058-grafana-59cd48d794-4459m         "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"2"}]},{"type":"text","value":"/2     Running   "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"0"}]},{"type":"text","value":"          53s\n prometheus-kube-prometheus-stack-1602-prometheus-0                "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"3"}]},{"type":"text","value":"/3     Running   "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"1"}]},{"type":"text","value":"          23s\n\n$ kubectl -n prometheus port-forward kube-prometheus-stack-1602180058-grafana-59cd48d794-4459m "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"3000"}]},{"type":"text","value":"\n  Forwarding from "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"127.0"}]},{"type":"text","value":".0.1:3000 -"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"3000"}]},{"type":"text","value":"\n  Forwarding from "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"text","value":"::1"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]},{"type":"text","value":":3000 -"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"3000"}]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Access "},{"type":"element","tagName":"a","properties":{"href":"http://localhost:3000","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"http://localhost:3000"}]},{"type":"text","value":" with browser and use the credentials admin / prom-operator. At the top left you can browse different dashboards:"}]},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 920px; margin-bottom: 1rem;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/763a2dacb95544a5bf74f4f6340480f8/47f6c/grafana1.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 68.69565217391305%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB60lEQVQoz3VRy27TUBD1N9Akvr5vvxM/kyZxIA2IikWFKhBSW6kLYMEClQ3fwKaLiq+gAYmKJgGhhAU/x3FMrFAF6Wg0d2bOzJm5xu9fq+VyeTv78Wn69frzzfX0Zvrl22yxnH9fAQvYxWo2X97Of843wRpGHkdC2kw6QrkWU2tI0xKmxYklKNOUa5OIvaZFqLSoQryGIe3AC2LX7yjbL9NMwYJQYdNO1X6dAgzHC4fFZFBMkrSP4coOtBNw6VSN/od1VhpQwqXLhSOkZzuhkG6LcOhsmXw3SGlJqR9kpqT2lQ6wZ+nYARLb2rbBuCaUm5S7foxiw+JaOWEn6bnYPIi128YVdkIoL87Hvf5RmjwU2kPEqM6T5oN2lGkUaW/ntqi5R8hpcf7+7CIfDgkpgyALyu12lEMG3hBf3eNOC8pUk8qRdMbC3DMbFiuPb1Rd02yQdYs43cepmbBxQtg7k1uEdXtPjo/e9fJD+OVXCeWgTZT0wk6G+YAfJgDIlYqa3DStRw9O3pxf3h8cwy/JlP3dGf+MyVl3CAuEnRQqavGoaZjW4eTs4vXH8eh5oyJvJu9XY6O4Cwlp1o/K+0f/TCb0YPTi1cmHov+0SdZkxw3xscm6Gqgc14/Wx+PbZEx7fHD69uXVuHhWyf4D/bCSZ54GgsYAAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"picture","properties":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tagName":"source","properties":{"srcSet":["/static/763a2dacb95544a5bf74f4f6340480f8/a0b58/grafana1.webp 230w","/static/763a2dacb95544a5bf74f4f6340480f8/bc10c/grafana1.webp 460w","/static/763a2dacb95544a5bf74f4f6340480f8/966d8/grafana1.webp 920w","/static/763a2dacb95544a5bf74f4f6340480f8/445df/grafana1.webp 1380w","/static/763a2dacb95544a5bf74f4f6340480f8/78de1/grafana1.webp 1840w","/static/763a2dacb95544a5bf74f4f6340480f8/15eef/grafana1.webp 2206w"],"sizes":["(max-width:","920px)","100vw,","920px"],"type":"image/webp"},"children":[]},{"type":"text","value":"\n        "},{"type":"element","tagName":"source","properties":{"srcSet":["/static/763a2dacb95544a5bf74f4f6340480f8/81c8e/grafana1.png 230w","/static/763a2dacb95544a5bf74f4f6340480f8/08a84/grafana1.png 460w","/static/763a2dacb95544a5bf74f4f6340480f8/c0255/grafana1.png 920w","/static/763a2dacb95544a5bf74f4f6340480f8/b1001/grafana1.png 1380w","/static/763a2dacb95544a5bf74f4f6340480f8/161ec/grafana1.png 1840w","/static/763a2dacb95544a5bf74f4f6340480f8/47f6c/grafana1.png 2206w"],"sizes":["(max-width:","920px)","100vw,","920px"],"type":"image/png"},"children":[]},{"type":"text","value":"\n        "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"src":"/static/763a2dacb95544a5bf74f4f6340480f8/c0255/grafana1.png","alt":"grafana1","title":"grafana1","loading":"lazy","style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"},"children":[]},{"type":"text","value":"\n      "}]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The dashboards show already lots of interesting information about the cluster but we'd really like to know more about the apps we're running as well. Let's add "},{"type":"element","tagName":"a","properties":{"href":"https://grafana.com/oss/loki/","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Loki"}]},{"type":"text","value":" so that we can see logs."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"To confirm that everything works we should have an application that'll output something to stdout. Let's run the Redis application from previously by applying "},{"type":"element","tagName":"a","properties":{"href":"https://raw.githubusercontent.com/kubernetes-hy/material-example/master/app5/manifests/statefulset.yaml","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"this"}]},{"type":"text","value":" manifest. We can keep it running as it'll generate a good amount of log output for us."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/grafana/helm-charts/tree/main/charts/loki-stack","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Loki-stack Chart"}]},{"type":"text","value":" includes everything we need:"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"shell"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-shell"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-shell"]},"children":[{"type":"text","value":"$ helm repo "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"add"}]},{"type":"text","value":" grafana https://grafana.github.io/helm-charts\n$ helm repo update\n$ kubectl create namespace loki-stack\n  namespace/loki-stack created\n\n$ helm upgrade --install loki --namespace"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":"loki-stack grafana/loki-stack\n\n$ kubectl get all -n loki-stack\n  NAME                      READY   STATUS    RESTARTS   AGE\n  pod/loki-promtail-n2fgs   "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"1"}]},{"type":"text","value":"/1     Running   "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"0"}]},{"type":"text","value":"          18m\n  pod/loki-promtail-h6xq2   "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"1"}]},{"type":"text","value":"/1     Running   "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"0"}]},{"type":"text","value":"          18m\n  pod/loki-promtail-8l84g   "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"1"}]},{"type":"text","value":"/1     Running   "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"0"}]},{"type":"text","value":"          18m\n  pod/loki-0                "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"1"}]},{"type":"text","value":"/1     Running   "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"0"}]},{"type":"text","value":"          18m\n\n  NAME                    TYPE        CLUSTER-IP     EXTERNAL-IP   PORT"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"S"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"    AGE\n  service/loki            ClusterIP   "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"10.43"}]},{"type":"text","value":".170.68   "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"none"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]},{"type":"text","value":"        "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"3100"}]},{"type":"text","value":"/TCP   18m\n  service/loki-headless   ClusterIP   None           "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"none"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]},{"type":"text","value":"        "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"3100"}]},{"type":"text","value":"/TCP   18m\n\n  NAME                           DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR   AGE\n  daemonset.apps/loki-promtail   "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"3"}]},{"type":"text","value":"         "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"3"}]},{"type":"text","value":"         "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"3"}]},{"type":"text","value":"       "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"3"}]},{"type":"text","value":"            "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"3"}]},{"type":"text","value":"           "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"none"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]},{"type":"text","value":"          18m\n\n  NAME                    READY   AGE\n  statefulset.apps/loki   "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"1"}]},{"type":"text","value":"/1     18m"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Here we see that Loki is running in port 3100. As an additional bonus, because we installed the loki-stack, we've got "},{"type":"element","tagName":"a","properties":{"href":"https://grafana.com/docs/loki/latest/clients/promtail/","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Promtail"}]},{"type":"text","value":", which makes it trivial for us to send logs from our applications to Loki. So trivial in fact, that we don't have to do anything except configure Grafana to show Loki."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Open Grafana, go to settings, and choose "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"Connections"}]},{"type":"text","value":", "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"Data Sources"}]},{"type":"text","value":", and then "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"Add data source"}]},{"type":"text","value":". Choose Loki and then insert the correct URL. From the output above we can guess that the port should be 3100, the namespace is loki-stack and the name of the service is loki. So the answer would be "},{"type":"element","tagName":"a","properties":{"href":"http://loki.loki-stack:3100","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"http://loki.loki-stack:3100"}]},{"type":"text","value":". No other fields need to be changed."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Now we can use the Explore tab (compass) to explore the data."}]},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 920px; margin-bottom: 1rem;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/3c7704dc75630a8d3f369a23b46c8b9f/cf8e5/loki_app_redisapp.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 48.26086956521739%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABPElEQVQoz5XR3U7CMBgG4F4D4Ma6r/tvt/Ez2CYyNEAwEaLGE/FADzz2/q/g9XMYTTww7ODJ26zN27UV5BkQBbBsQq/noD+Q6PWdsw0swlAGiJULTQ6EG2RI8gpelMHXGciL4VAEV8VweSx5/B+HwjbJN1CBgQiSHOPZAqOi5uIJvFDjYkg8qRHynC19WNJr027zr9N365uQKuISgzidtBwVwnb9nwWW87v4HCLSI/iRgeSiJJtCcbnkow7bUsW7dyPKqx2q1R5p0UDnBfJpha9rkH4KGc1Y0Ykomz2qmydk8w3fWcp/q/nVCLaXgtIGrlmCOhDl6gH1+hlZdQdlFi3SNVy9hMo3UNma83yivH5EtTkiv7wH5Vv441sk8wPUaHsq7Egsdm9YHj4wXb8jqI4I6xeY5rXNgIUdfQKYqx6JP/YckAAAAABJRU5ErkJggg=='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"picture","properties":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tagName":"source","properties":{"srcSet":["/static/3c7704dc75630a8d3f369a23b46c8b9f/a0b58/loki_app_redisapp.webp 230w","/static/3c7704dc75630a8d3f369a23b46c8b9f/bc10c/loki_app_redisapp.webp 460w","/static/3c7704dc75630a8d3f369a23b46c8b9f/966d8/loki_app_redisapp.webp 920w","/static/3c7704dc75630a8d3f369a23b46c8b9f/445df/loki_app_redisapp.webp 1380w","/static/3c7704dc75630a8d3f369a23b46c8b9f/7e452/loki_app_redisapp.webp 1402w"],"sizes":["(max-width:","920px)","100vw,","920px"],"type":"image/webp"},"children":[]},{"type":"text","value":"\n        "},{"type":"element","tagName":"source","properties":{"srcSet":["/static/3c7704dc75630a8d3f369a23b46c8b9f/81c8e/loki_app_redisapp.png 230w","/static/3c7704dc75630a8d3f369a23b46c8b9f/08a84/loki_app_redisapp.png 460w","/static/3c7704dc75630a8d3f369a23b46c8b9f/c0255/loki_app_redisapp.png 920w","/static/3c7704dc75630a8d3f369a23b46c8b9f/b1001/loki_app_redisapp.png 1380w","/static/3c7704dc75630a8d3f369a23b46c8b9f/cf8e5/loki_app_redisapp.png 1402w"],"sizes":["(max-width:","920px)","100vw,","920px"],"type":"image/png"},"children":[]},{"type":"text","value":"\n        "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"src":"/static/3c7704dc75630a8d3f369a23b46c8b9f/c0255/loki_app_redisapp.png","alt":"loki app redisapp","title":"loki app redisapp","loading":"lazy","style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"},"children":[]},{"type":"text","value":"\n      "}]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]},{"type":"element","tagName":"exercise","properties":{"name":"Exercise 2.10: Project v1.3"},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"  The project could really use logging."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"  Add request logging so that you can monitor every "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"todo"}]},{"type":"text","value":" that is sent to the backend."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"  Set the limit of 140 characters for todos into the backend as well. Use Postman or curl to test that too long todos are blocked by the backend and you can see the non-allowed messages in your Grafana."}]}]},{"type":"element","tagName":"h3","properties":{"id":"the-easy-way-out","style":"position:relative;"},"children":[{"type":"text","value":"The easy way out"},{"type":"element","tagName":"a","properties":{"href":"#the-easy-way-out","ariaLabel":"the easy way out permalink","className":["anchor","after"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"There was an easier way for us to install Prometheus with a few clicks. If you have to install it again you can try this:"}]},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Open "},{"type":"element","tagName":"a","properties":{"href":"https://k8slens.dev/","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Lens"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Right click the cluster icon in the top left and choose \"Settings\""}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Scroll down and under \"Features\" under \"Metrics\" you can press \"Install\""}]},{"type":"text","value":"\n"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"A great option especially for your local cluster or hobby cluster."}]}]},"html":"<div><text-box variant='learningObjectives' name='Learning Objectives'><p>After this section you</p><ul>\n<li>know of the wide array of tools used for monitoring and can implement simple logging</li>\n<li>know about CRDs or Custom Resource Definitions</li>\n<li>know about Helm, the package manager for Kubernetes</li>\n</ul></text-box><p>Our cluster and the apps in it have so far been pretty much a black box for us. We've thrown stuff in and then hoped that everything works all right. We're now going to use <a href=\"https://prometheus.io/\" target=\"_blank\" rel=\"noopener noreferrer\">Prometheus</a> to monitor the cluster and <a href=\"https://grafana.com/\" target=\"_blank\" rel=\"noopener noreferrer\">Grafana</a> to view the data.</p><p>Before we can get started let's look into how Kubernetes applications are managed more easily. <a href=\"https://helm.sh/\" target=\"_blank\" rel=\"noopener noreferrer\">Helm</a> uses a packaging format called <em>charts</em> to define the dependencies of an application. Among other things, Helm Charts include information for the version of the chart, the requirements of the application such as the Kubernetes version as well as other charts that it may depend on.</p><p>Installation instructions for Helm are found <a href=\"https://helm.sh/docs/intro/install/\" target=\"_blank\" rel=\"noopener noreferrer\">here</a>.</p><p>After the installation, we can add the official charts repository:</p><div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ helm repo <span class=\"token function\">add</span> prometheus-community https://prometheus-community.github.io/helm-charts\n$ helm repo <span class=\"token function\">add</span> stable https://charts.helm.sh/stable</code></pre></div><p>Next, we can install the <a href=\"https://artifacthub.io/packages/helm/prometheus-community/kube-prometheus-stack\" target=\"_blank\" rel=\"noopener noreferrer\">kube-prometheus-stack</a>. By default, this would put everything in the default namespace. Let's create a new namespace and add it there.</p><div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ kubectl create namespace prometheus\n$ helm <span class=\"token function\">install</span> prometheus-community/kube-prometheus-stack --generate-name --namespace prometheus\n<span class=\"token punctuation\">..</span>.\nNAME: kube-prometheus-stack-1635945330\nLAST DEPLOYED: Wed Nov  <span class=\"token number\">3</span> <span class=\"token number\">15</span>:15:37 <span class=\"token number\">2021</span>\nNAMESPACE: prometheus\nSTATUS: deployed\nREVISION: <span class=\"token number\">1</span>\nNOTES:\nkube-prometheus-stack has been installed. Check its status by running:\n  kubectl --namespace prometheus get pods -l <span class=\"token string\">\"release=kube-prometheus-stack-1635945330\"</span></code></pre></div><p>This added a lot of stuff to our cluster. Among other things, it added a number of <a href=\"https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/\" target=\"_blank\" rel=\"noopener noreferrer\">custom resources</a>. They are a way to extend the Kubernetes APIs to offer new resources that Kubernetes doesn't support out of the box. We will be designing our own custom resources in <a href=\"https://devopswithkubernetes.com/part5/\" target=\"_blank\" rel=\"noopener noreferrer\">part 5</a>.</p><p>You can remove almost anything with <code class=\"language-text\">helm delete [name]</code> with the name found using the command <code class=\"language-text\">helm list -n prometheus</code>. Custom resource definitions are left and have to be manually removed if the need arises. The definitions don't do anything by themselves so leaving them does no harm.</p><p>Let us open a way into Grafana so we can see the data.</p><div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ kubectl get po -n prometheus\n NAME                                                              READY   STATUS    RESTARTS   AGE\n kube-prometheus-stack-1602180058-prometheus-node-exporter-nt8cp   <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          53s\n kube-prometheus-stack-1602180058-prometheus-node-exporter-ft7dg   <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          53s\n kube-prometheus-stack-1602-operator-557c9c4f5-wbsqc               <span class=\"token number\">2</span>/2     Running   <span class=\"token number\">0</span>          53s\n kube-prometheus-stack-1602180058-prometheus-node-exporter-tr7ns   <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          53s\n kube-prometheus-stack-1602180058-kube-state-metrics-55dccdkkz6w   <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          53s\n alertmanager-kube-prometheus-stack-1602-alertmanager-0            <span class=\"token number\">2</span>/2     Running   <span class=\"token number\">0</span>          35s\n kube-prometheus-stack-1602180058-grafana-59cd48d794-4459m         <span class=\"token number\">2</span>/2     Running   <span class=\"token number\">0</span>          53s\n prometheus-kube-prometheus-stack-1602-prometheus-0                <span class=\"token number\">3</span>/3     Running   <span class=\"token number\">1</span>          23s\n\n$ kubectl -n prometheus port-forward kube-prometheus-stack-1602180058-grafana-59cd48d794-4459m <span class=\"token number\">3000</span>\n  Forwarding from <span class=\"token number\">127.0</span>.0.1:3000 -<span class=\"token operator\">></span> <span class=\"token number\">3000</span>\n  Forwarding from <span class=\"token punctuation\">[</span>::1<span class=\"token punctuation\">]</span>:3000 -<span class=\"token operator\">></span> <span class=\"token number\">3000</span></code></pre></div><p>Access <a href=\"http://localhost:3000\" target=\"_blank\" rel=\"noopener noreferrer\">http://localhost:3000</a> with browser and use the credentials admin / prom-operator. At the top left you can browse different dashboards:</p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 920px; margin-bottom: 1rem;\">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/763a2dacb95544a5bf74f4f6340480f8/47f6c/grafana1.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 68.69565217391305%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB60lEQVQoz3VRy27TUBD1N9Akvr5vvxM/kyZxIA2IikWFKhBSW6kLYMEClQ3fwKaLiq+gAYmKJgGhhAU/x3FMrFAF6Wg0d2bOzJm5xu9fq+VyeTv78Wn69frzzfX0Zvrl22yxnH9fAQvYxWo2X97Of843wRpGHkdC2kw6QrkWU2tI0xKmxYklKNOUa5OIvaZFqLSoQryGIe3AC2LX7yjbL9NMwYJQYdNO1X6dAgzHC4fFZFBMkrSP4coOtBNw6VSN/od1VhpQwqXLhSOkZzuhkG6LcOhsmXw3SGlJqR9kpqT2lQ6wZ+nYARLb2rbBuCaUm5S7foxiw+JaOWEn6bnYPIi128YVdkIoL87Hvf5RmjwU2kPEqM6T5oN2lGkUaW/ntqi5R8hpcf7+7CIfDgkpgyALyu12lEMG3hBf3eNOC8pUk8qRdMbC3DMbFiuPb1Rd02yQdYs43cepmbBxQtg7k1uEdXtPjo/e9fJD+OVXCeWgTZT0wk6G+YAfJgDIlYqa3DStRw9O3pxf3h8cwy/JlP3dGf+MyVl3CAuEnRQqavGoaZjW4eTs4vXH8eh5oyJvJu9XY6O4Cwlp1o/K+0f/TCb0YPTi1cmHov+0SdZkxw3xscm6Gqgc14/Wx+PbZEx7fHD69uXVuHhWyf4D/bCSZ54GgsYAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;\"></span>\n  <picture>\n        <source srcset=\"/static/763a2dacb95544a5bf74f4f6340480f8/a0b58/grafana1.webp 230w,\n/static/763a2dacb95544a5bf74f4f6340480f8/bc10c/grafana1.webp 460w,\n/static/763a2dacb95544a5bf74f4f6340480f8/966d8/grafana1.webp 920w,\n/static/763a2dacb95544a5bf74f4f6340480f8/445df/grafana1.webp 1380w,\n/static/763a2dacb95544a5bf74f4f6340480f8/78de1/grafana1.webp 1840w,\n/static/763a2dacb95544a5bf74f4f6340480f8/15eef/grafana1.webp 2206w\" sizes=\"(max-width: 920px) 100vw, 920px\" type=\"image/webp\">\n        <source srcset=\"/static/763a2dacb95544a5bf74f4f6340480f8/81c8e/grafana1.png 230w,\n/static/763a2dacb95544a5bf74f4f6340480f8/08a84/grafana1.png 460w,\n/static/763a2dacb95544a5bf74f4f6340480f8/c0255/grafana1.png 920w,\n/static/763a2dacb95544a5bf74f4f6340480f8/b1001/grafana1.png 1380w,\n/static/763a2dacb95544a5bf74f4f6340480f8/161ec/grafana1.png 1840w,\n/static/763a2dacb95544a5bf74f4f6340480f8/47f6c/grafana1.png 2206w\" sizes=\"(max-width: 920px) 100vw, 920px\" type=\"image/png\">\n        <img class=\"gatsby-resp-image-image\" src=\"/static/763a2dacb95544a5bf74f4f6340480f8/c0255/grafana1.png\" alt=\"grafana1\" title=\"grafana1\" loading=\"lazy\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\">\n      </picture>\n  </a>\n    </span><p>The dashboards show already lots of interesting information about the cluster but we'd really like to know more about the apps we're running as well. Let's add <a href=\"https://grafana.com/oss/loki/\" target=\"_blank\" rel=\"noopener noreferrer\">Loki</a> so that we can see logs.</p><p>To confirm that everything works we should have an application that'll output something to stdout. Let's run the Redis application from previously by applying <a href=\"https://raw.githubusercontent.com/kubernetes-hy/material-example/master/app5/manifests/statefulset.yaml\" target=\"_blank\" rel=\"noopener noreferrer\">this</a> manifest. We can keep it running as it'll generate a good amount of log output for us.</p><p>The <a href=\"https://github.com/grafana/helm-charts/tree/main/charts/loki-stack\" target=\"_blank\" rel=\"noopener noreferrer\">Loki-stack Chart</a> includes everything we need:</p><div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ helm repo <span class=\"token function\">add</span> grafana https://grafana.github.io/helm-charts\n$ helm repo update\n$ kubectl create namespace loki-stack\n  namespace/loki-stack created\n\n$ helm upgrade --install loki --namespace<span class=\"token operator\">=</span>loki-stack grafana/loki-stack\n\n$ kubectl get all -n loki-stack\n  NAME                      READY   STATUS    RESTARTS   AGE\n  pod/loki-promtail-n2fgs   <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          18m\n  pod/loki-promtail-h6xq2   <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          18m\n  pod/loki-promtail-8l84g   <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          18m\n  pod/loki-0                <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          18m\n\n  NAME                    TYPE        CLUSTER-IP     EXTERNAL-IP   PORT<span class=\"token punctuation\">(</span>S<span class=\"token punctuation\">)</span>    AGE\n  service/loki            ClusterIP   <span class=\"token number\">10.43</span>.170.68   <span class=\"token operator\">&lt;</span>none<span class=\"token operator\">></span>        <span class=\"token number\">3100</span>/TCP   18m\n  service/loki-headless   ClusterIP   None           <span class=\"token operator\">&lt;</span>none<span class=\"token operator\">></span>        <span class=\"token number\">3100</span>/TCP   18m\n\n  NAME                           DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR   AGE\n  daemonset.apps/loki-promtail   <span class=\"token number\">3</span>         <span class=\"token number\">3</span>         <span class=\"token number\">3</span>       <span class=\"token number\">3</span>            <span class=\"token number\">3</span>           <span class=\"token operator\">&lt;</span>none<span class=\"token operator\">></span>          18m\n\n  NAME                    READY   AGE\n  statefulset.apps/loki   <span class=\"token number\">1</span>/1     18m</code></pre></div><p>Here we see that Loki is running in port 3100. As an additional bonus, because we installed the loki-stack, we've got <a href=\"https://grafana.com/docs/loki/latest/clients/promtail/\" target=\"_blank\" rel=\"noopener noreferrer\">Promtail</a>, which makes it trivial for us to send logs from our applications to Loki. So trivial in fact, that we don't have to do anything except configure Grafana to show Loki.</p><p>Open Grafana, go to settings, and choose <em>Connections</em>, <em>Data Sources</em>, and then <em>Add data source</em>. Choose Loki and then insert the correct URL. From the output above we can guess that the port should be 3100, the namespace is loki-stack and the name of the service is loki. So the answer would be <a href=\"http://loki.loki-stack:3100\" target=\"_blank\" rel=\"noopener noreferrer\">http://loki.loki-stack:3100</a>. No other fields need to be changed.</p><p>Now we can use the Explore tab (compass) to explore the data.</p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 920px; margin-bottom: 1rem;\">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/3c7704dc75630a8d3f369a23b46c8b9f/cf8e5/loki_app_redisapp.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 48.26086956521739%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABPElEQVQoz5XR3U7CMBgG4F4D4Ma6r/tvt/Ez2CYyNEAwEaLGE/FADzz2/q/g9XMYTTww7ODJ26zN27UV5BkQBbBsQq/noD+Q6PWdsw0swlAGiJULTQ6EG2RI8gpelMHXGciL4VAEV8VweSx5/B+HwjbJN1CBgQiSHOPZAqOi5uIJvFDjYkg8qRHynC19WNJr027zr9N365uQKuISgzidtBwVwnb9nwWW87v4HCLSI/iRgeSiJJtCcbnkow7bUsW7dyPKqx2q1R5p0UDnBfJpha9rkH4KGc1Y0Ykomz2qmydk8w3fWcp/q/nVCLaXgtIGrlmCOhDl6gH1+hlZdQdlFi3SNVy9hMo3UNma83yivH5EtTkiv7wH5Vv441sk8wPUaHsq7Egsdm9YHj4wXb8jqI4I6xeY5rXNgIUdfQKYqx6JP/YckAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;\"></span>\n  <picture>\n        <source srcset=\"/static/3c7704dc75630a8d3f369a23b46c8b9f/a0b58/loki_app_redisapp.webp 230w,\n/static/3c7704dc75630a8d3f369a23b46c8b9f/bc10c/loki_app_redisapp.webp 460w,\n/static/3c7704dc75630a8d3f369a23b46c8b9f/966d8/loki_app_redisapp.webp 920w,\n/static/3c7704dc75630a8d3f369a23b46c8b9f/445df/loki_app_redisapp.webp 1380w,\n/static/3c7704dc75630a8d3f369a23b46c8b9f/7e452/loki_app_redisapp.webp 1402w\" sizes=\"(max-width: 920px) 100vw, 920px\" type=\"image/webp\">\n        <source srcset=\"/static/3c7704dc75630a8d3f369a23b46c8b9f/81c8e/loki_app_redisapp.png 230w,\n/static/3c7704dc75630a8d3f369a23b46c8b9f/08a84/loki_app_redisapp.png 460w,\n/static/3c7704dc75630a8d3f369a23b46c8b9f/c0255/loki_app_redisapp.png 920w,\n/static/3c7704dc75630a8d3f369a23b46c8b9f/b1001/loki_app_redisapp.png 1380w,\n/static/3c7704dc75630a8d3f369a23b46c8b9f/cf8e5/loki_app_redisapp.png 1402w\" sizes=\"(max-width: 920px) 100vw, 920px\" type=\"image/png\">\n        <img class=\"gatsby-resp-image-image\" src=\"/static/3c7704dc75630a8d3f369a23b46c8b9f/c0255/loki_app_redisapp.png\" alt=\"loki app redisapp\" title=\"loki app redisapp\" loading=\"lazy\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\">\n      </picture>\n  </a>\n    </span><exercise name='Exercise 2.10: Project v1.3'><p>  The project could really use logging.</p><p>  Add request logging so that you can monitor every <em>todo</em> that is sent to the backend.</p><p>  Set the limit of 140 characters for todos into the backend as well. Use Postman or curl to test that too long todos are blocked by the backend and you can see the non-allowed messages in your Grafana.</p></exercise><h3 id=\"the-easy-way-out\" style=\"position:relative;\">The easy way out<a href=\"#the-easy-way-out\" aria-label=\"the easy way out permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3><p>There was an easier way for us to install Prometheus with a few clicks. If you have to install it again you can try this:</p><ol>\n<li>Open <a href=\"https://k8slens.dev/\" target=\"_blank\" rel=\"noopener noreferrer\">Lens</a></li>\n<li>Right click the cluster icon in the top left and choose \"Settings\"</li>\n<li>Scroll down and under \"Features\" under \"Metrics\" you can press \"Install\"</li>\n</ol><p>A great option especially for your local cluster or hobby cluster.</p></div>","frontmatter":{"path":"/part-2/5-monitoring","title":"Monitoring"},"fileAbsolutePath":"/home/runner/work/dwk2024/dwk2024/data/part-2/5-monitoring.md"},"allPages":{"edges":[{"node":{"id":"7e706a38-3828-5118-bdec-3705a319a1b0","frontmatter":{"path":"/faq-vi","title":"Câu hỏi thường gặp"}}},{"node":{"id":"5225f2a2-20f9-50ce-93ac-7b38f3105103","frontmatter":{"path":"/faq","title":"FAQ"}}},{"node":{"id":"e1ed6713-5992-5f7f-95a1-17efd97f57d8","frontmatter":{"path":"/frontmatter-guide","title":"Frontmatter-guide"}}},{"node":{"id":"04c5ddbd-7839-580f-82da-bc9fdbb49f84","frontmatter":{"path":"/known-problems-solutions-vi","title":"Các vấn đề bạn có thể gặp phải"}}},{"node":{"id":"3102d88f-7297-56fb-af03-27d1079fffd1","frontmatter":{"path":"/","title":"Trang chủ"}}},{"node":{"id":"c92ea568-3384-5ff8-8dfa-b9015597780d","frontmatter":{"path":"/known-problems-solutions","title":"Issues you may face"}}},{"node":{"id":"52d4cd1d-eb14-54f3-a18a-ef84b67c320d","frontmatter":{"path":"/index-en","title":"Homepage"}}},{"node":{"id":"5e6b6ee0-b381-53f0-b84c-af378792b131","frontmatter":{"path":"/registration-and-completion","title":"Registration and Completion"}}},{"node":{"id":"58688080-4aa8-54e6-8b8b-02de1c4f6410","frontmatter":{"path":"/unity-assignment","title":"Unity Assignment"}}},{"node":{"id":"d9c993b6-f6b4-59a1-b119-f3b7218eec6b","frontmatter":{"path":"/sanasto","title":"Sanasto"}}},{"node":{"id":"8a3ee5be-7557-5fcd-954b-2351e74cd585","frontmatter":{"path":"/part-0/1-intro-vi","title":"Giới thiệu khóa học"}}},{"node":{"id":"23082016-7bbd-5215-8485-4ffccbf3ea1a","frontmatter":{"path":"/part-0/1-intro","title":"Course Introduction"}}},{"node":{"id":"771eaa93-2ef2-5e0f-9e1e-55914c67c4ac","frontmatter":{"path":"/part-0","title":"Part 0"}}},{"node":{"id":"fe0342aa-a4c5-5b44-8591-71eb27f1a287","frontmatter":{"path":"/part-1/2-introduction-to-debugging-vi","title":"Giới thiệu về Debugging"}}},{"node":{"id":"1c236933-7ad5-5b61-8c07-07db3822d55a","frontmatter":{"path":"/part-1/2-introduction-to-debugging","title":"Introduction to Debugging"}}},{"node":{"id":"3c788edf-62db-5e86-9366-17b53eda9244","frontmatter":{"path":"/part-1/5-summary","title":"Summary"}}},{"node":{"id":"8ed3365b-b788-5806-8ec5-bec3cb0f94c8","frontmatter":{"path":"/part-1","title":"Part 1"}}},{"node":{"id":"7fc5c062-6b94-53ec-9aaa-adca66ce672e","frontmatter":{"path":"/part-1/5-summary-vi","title":"Tóm tắt"}}},{"node":{"id":"46a4a0e4-d131-537d-aa72-5b6726163a7d","frontmatter":{"path":"/part-2/1-networking-between-pods-vi","title":"Kết nối mạng giữa các pod"}}},{"node":{"id":"fd467661-6b24-545f-904c-52f4a7ade6b7","frontmatter":{"path":"/part-2/1-networking-between-pods","title":"Networking between pods"}}},{"node":{"id":"56110eda-875d-5bd9-a400-5bd5a009df7f","frontmatter":{"path":"/part-2/5-monitoring-vi","title":"Giám sát"}}},{"node":{"id":"8f3387b0-ec6e-5a86-982a-e52780d911f9","frontmatter":{"path":"/part-2/5-monitoring","title":"Monitoring"}}},{"node":{"id":"06173ac4-c2f8-57df-8dc8-450b5c2bb695","frontmatter":{"path":"/part-2/6-summary","title":"Summary"}}},{"node":{"id":"79f1cddb-6995-51c2-bf98-2adc13de9b13","frontmatter":{"path":"/part-2/6-summary-vi","title":"Tóm tắt"}}},{"node":{"id":"8c3d747d-4f87-5a46-99ac-dfd0af5a893b","frontmatter":{"path":"/part-2","title":"Part 2"}}},{"node":{"id":"8d9fd774-9dbe-5cca-8395-9226fcf82c4a","frontmatter":{"path":"/part-3/4-summary-vi","title":"Tóm tắt"}}},{"node":{"id":"b98b2895-6c9d-5234-939d-2f547cbf8a06","frontmatter":{"path":"/part-3/4-summary","title":"Summary"}}},{"node":{"id":"29bec4f5-8a0b-580d-ac84-9dbbd1d7152e","frontmatter":{"path":"/part-3","title":"Part 3"}}},{"node":{"id":"4dd8302d-d170-5d38-8198-4d0947322bbc","frontmatter":{"path":"/part-4/4-summary-vi","title":"Tóm tắt"}}},{"node":{"id":"0045695d-e541-5acc-b4b8-551023d01733","frontmatter":{"path":"/part-4/4-summary","title":"Summary"}}},{"node":{"id":"a917b24d-df2b-5199-ac98-cd0f7560c63f","frontmatter":{"path":"/part-4","title":"Part 4"}}},{"node":{"id":"eb339401-26c8-594c-98fd-2f30a95275cd","frontmatter":{"path":"/part-5/4-beyond-kubernetes-vi","title":"Vượt ra ngoài Kubernetes"}}},{"node":{"id":"2318c18f-86e6-5a4e-958a-d1c38f8615cd","frontmatter":{"path":"/part-5/4-beyond-kubernetes","title":"Beyond Kubernetes"}}},{"node":{"id":"781bd207-902e-59a2-a752-4958c2c93fb0","frontmatter":{"path":"/part-5/5-summary-vi","title":"Tóm tắt và kết thúc"}}},{"node":{"id":"1d8ff75c-065b-565d-9ceb-01b9a276ae7a","frontmatter":{"path":"/part-5/5-summary","title":"Summary and end"}}},{"node":{"id":"829fd216-f995-5a77-b201-bb971aec73b4","frontmatter":{"path":"/part-0/2-kubernetes-in-three-diagrams-vi","title":"Kubernetes qua ba sơ đồ"}}},{"node":{"id":"98132cca-4dc3-5942-a6f4-1da87bc81a23","frontmatter":{"path":"/part-0/2-kubernetes-in-three-diagrams","title":"Kubernetes in three diagrams"}}},{"node":{"id":"90b8e83a-9d55-550a-908a-316708ce7f8c","frontmatter":{"path":"/part-1/3-introduction-to-networking","title":"Introduction to Networking"}}},{"node":{"id":"8931bcb7-c40e-5d57-aa80-c4333972fbb8","frontmatter":{"path":"/part-1/3-introduction-to-networking-vi","title":"Giới thiệu về Mạng"}}},{"node":{"id":"4fe00c0a-bb17-5d4c-8202-750493a755c9","frontmatter":{"path":"/part-1/4-introduction-to-storage-vi","title":"Giới thiệu về Lưu trữ"}}},{"node":{"id":"6cc3be66-6091-58fc-bcbd-1f27f9473f85","frontmatter":{"path":"/part-1/4-introduction-to-storage","title":"Introduction to Storage"}}},{"node":{"id":"b53df746-c24f-57e3-a9f3-d6d621697689","frontmatter":{"path":"/part-2/2-organizing-a-cluster-vi","title":"Tổ chức một cụm"}}},{"node":{"id":"d5206d16-d2fe-51fd-8acd-d85ecf0be257","frontmatter":{"path":"/part-2/2-organizing-a-cluster","title":"Organizing a cluster"}}},{"node":{"id":"15be3d7c-b0b7-5bce-b3bf-8cec39d54630","frontmatter":{"path":"/part-2/3-configuring-applications-vi","title":"Cấu hình ứng dụng"}}},{"node":{"id":"e4534a9d-fb84-5d1f-83f0-35055feb0da7","frontmatter":{"path":"/part-2/3-configuring-applications","title":"Configuring applications"}}},{"node":{"id":"466aa711-527b-55a0-871b-13468e65d344","frontmatter":{"path":"/part-2/4-statefulsets-and-jobs","title":"StatefulSets and Jobs"}}},{"node":{"id":"02389078-a12f-561a-8a54-fa99a6950b92","frontmatter":{"path":"/part-2/4-statefulsets-and-jobs-vi","title":"StatefulSet và Job"}}},{"node":{"id":"bea18f34-dcdc-59b8-ba24-3011680a0c58","frontmatter":{"path":"/part-3/1-introduction-to-gke-vi","title":"Giới thiệu về Google Kubernetes Engine"}}},{"node":{"id":"84db9628-b3df-5ca1-9d3d-5924e02ae549","frontmatter":{"path":"/part-3/1-introduction-to-gke","title":"Introduction to Google Kubernetes Engine"}}},{"node":{"id":"0049e57f-0bc7-5689-9169-43848a972877","frontmatter":{"path":"/part-3/2-deployment-pipeline-vi","title":"Quy trình Triển khai (Deployment Pipeline)"}}},{"node":{"id":"61f18dc7-1abf-5c75-9b54-0cee11c76a40","frontmatter":{"path":"/part-3/2-deployment-pipeline","title":"Deployment Pipeline"}}},{"node":{"id":"7dfec8c7-8ccb-50da-949d-ebd1de395dc4","frontmatter":{"path":"/part-3/3-gke-features-vi","title":"Các tính năng của GKE"}}},{"node":{"id":"423cbc46-2dfa-57e6-9dc5-761a93729600","frontmatter":{"path":"/part-3/3-gke-features","title":"GKE features"}}},{"node":{"id":"6df9c7be-f930-5827-a39c-0c1698b23600","frontmatter":{"path":"/part-4/3-gitops-vi","title":"Triển khai GitOps"}}},{"node":{"id":"46f9ce68-5ccd-5787-bd59-03852ad6fdcb","frontmatter":{"path":"/part-4/3-gitops","title":"GitOps"}}},{"node":{"id":"31927db3-2182-55c7-b680-663754461d14","frontmatter":{"path":"/part-5/1-kubernetes-internals","title":"Kubernetes Internals"}}},{"node":{"id":"68c64f9f-c9a5-544b-bafb-b061665cacd0","frontmatter":{"path":"/part-5/3-service-mesh-vi","title":"Service Mesh"}}},{"node":{"id":"da1f8069-17bc-5c8e-9310-117bcedf5acf","frontmatter":{"path":"/part-5/2-custom-resource-definitions-vi","title":"Định nghĩa Tài nguyên Tùy chỉnh (Custom Resource Definitions)"}}},{"node":{"id":"0e981ec1-99e0-5005-ba9f-4f626a81b7ce","frontmatter":{"path":"/part-5/1-kubernetes-internals-vi","title":"Bên trong Kubernetes"}}},{"node":{"id":"ccefb04a-5790-57f6-869b-d255b2203667","frontmatter":{"path":"/part-5/2-custom-resource-definitions","title":"Custom Resource Definitions"}}},{"node":{"id":"20ceed4e-761d-54d4-9acf-2669eac533c6","frontmatter":{"path":"/part-5/3-service-mesh","title":"Service Mesh"}}},{"node":{"id":"306c87f3-9adb-5d8b-a3ce-072f8e6cfa43","frontmatter":{"path":"/part-5","title":"Part 5"}}},{"node":{"id":"97ead58a-8493-5fdd-808e-d4a56de573b0","frontmatter":{"path":"/part-1/1-first-deploy","title":"First Deploy"}}},{"node":{"id":"c179c521-bb62-52bd-808b-d4869df5302a","frontmatter":{"path":"/part-4/1-update-strategies-and-prometheus-vi","title":"Chiến lược cập nhật và Prometheus"}}},{"node":{"id":"898b0354-f1a2-5664-97de-d84b16018395","frontmatter":{"path":"/part-4/1-update-strategies-and-prometheus","title":"Update Strategies and Prometheus"}}},{"node":{"id":"6f4f18ce-5aa9-5bb5-9d74-0a631a78e6b3","frontmatter":{"path":"/part-4/2-messaging-systems-vi","title":"Hệ thống nhắn tin"}}},{"node":{"id":"6981a9d7-619d-51a9-9490-74bc77c0f55b","frontmatter":{"path":"/part-4/2-messaging-systems","title":"Messaging Systems"}}},{"node":{"id":"a17c4c44-7396-543f-b6b4-7adf57808aa8","frontmatter":{"path":"/part-1/1-first-deploy-vi","title":"Triển khai đầu tiên"}}}]}},"pageContext":{}},"staticQueryHashes":["3294351120","994120085"]}